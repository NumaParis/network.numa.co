<!DOCTYPE html>
<html>
<head>
<meta charset=utf-8 />
<title>NUMA network</title>
<meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
<link rel="stylesheet" type="text/css" href="main.css">
<script src='https://api.mapbox.com/mapbox.js/v2.4.0/mapbox.js'></script>
<link href='https://api.mapbox.com/mapbox.js/v2.4.0/mapbox.css' rel='stylesheet' />
<link rel="stylesheet" type="text/css" class="ui" href="//oss.maxcdn.com/semantic-ui/2.1.8/components/grid.min.css">

<link rel="stylesheet" type="text/css" class="ui" href="//oss.maxcdn.com/semantic-ui/2.1.8/components/button.min.css">
<link rel="stylesheet" type="text/css" class="ui" href="//oss.maxcdn.com/semantic-ui/2.1.8/components/icon.min.css">
</head>
<body>



<!-- jQuery is required for this example. -->
<script src='https://code.jquery.com/jquery-1.11.0.min.js'></script>
<script src="mapdata.js"></script>

<div id='map'></div>



<div id="footer" class="ui grid">
    <div style="width:60%">
        <div class="ui grid">
          <div class="sixteen wide nested column">
            <img src="NUMA_logo.png" />
            <p id="legend">We believe entrepreneurs can change the world and our mission with the acceleration program at NUMA is to facilitate their growth at the most critical moment of their existence.
            </p>
          </div>
        </div>
      </div>
      <div style="width:40%">
      <nav class='menu-ui'>
        <a href='#' class='active' data-filter='all'>SHOW ALL</a>
        <a href='#' data-filter='NUMA'>NUMA</a>
        <a href='#' data-filter='ATALANTA'>ATALANTA</a>
        <a href='#' data-filter='GFE'>GFE</a>
        <a href='#' data-filter='GAN'>GAN</a>
      </nav>
    </div>
</div>





<script>
L.mapbox.accessToken = 'pk.eyJ1IjoibnVtYXBhcmlzIiwiYSI6ImNpbWhzZGcxcjAwMHR2cmx5OG0wZmo1dm8ifQ.CnnU3FL4KEFjzJWGmQycAw';

// In the propeties object for each marker define key's
// like `rentals`, `fuel`, `tackleshop` that are set to true for false
// depending on whether or they exist at a location.

var geojson = mapdata; //taken from mapdata.js


var map = L.mapbox.map('map', 'numaparis.88fc86ce')
    .setView([30.34, 48.86], 3)

var markers = L.mapbox.featureLayer();




markers.on('layeradd', function(e) {
  var marker = e.layer;
  var feature = marker.feature;

  console.log("properties: " + JSON.stringify(feature));

  // Create custom popup content
  var popupContent =  getHTML(feature.properties);

  // http://leafletjs.com/reference.html#popup
  marker.bindPopup(popupContent,{
      closeButton: false,
      minWidth: 200
  });
});

markers.setGeoJSON(geojson).addTo(map);


// var LeafIcon = L.Icon.extend({
//   options: {
//       shadowUrl: 'leaf-shadow.png',
//       iconSize:     [38, 95],
//       shadowSize:   [50, 64],
//       iconAnchor:   [22, 94],
//       shadowAnchor: [4, 62],
//       popupAnchor:  [-3, -76]
//   },

// });
// var CustomMarker = L.Marker.extend({
//     properties: {
//         "title": "NUMA Paris",
//         "NUMA": true,
//         "GFE": false,
//         "ATALANTA": false,
//         "GAN": false,
//     },
// });
// var greenIcon = new LeafIcon({iconUrl: 'leaf-red.png'})
// var marker = L.marker([51.5, -0.09], {icon: greenIcon});
// var markerJSON = marker.toGeoJSON();
// console.log("marker json: " + JSON.stringify(markerJSON));
//marker.addTo(map).bindPopup("I am a green leaf.");


$('.menu-ui a').on('click', function() {
    // For each filter link, get the 'data-filter' attribute value.
    var filter = $(this).data('filter');
    $(this).addClass('active').siblings().removeClass('active');
    markers.setFilter(function(f) {
        // If the data-filter attribute is set to "all", return
        // all (true). Otherwise, filter on markers that have
        // a value set to true based on the filter name.
        return (filter === 'all') ? true : f.properties[filter] === true;
    });
    return false;
});

function getHTML({ name, website, city, country, id }) {

    console.log("website " + website);

    return  '<div id="' + id + '" class="popup">' +
      '<h1>' + name + '</h1>' +
      '<p>' + city + ", " + country + '</p>' +
      '<a target="_blank" href="' + website + '">' + website +'</a>'
    '</div>'

};


</script>

</body>
</html>
